<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Lanzafame.GitHub.io by Lanzafame</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Lanzafame.GitHub.io</h1>
        <h2></h2>
        <a href="https://github.com/Lanzafame" class="button"><small>Follow me on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <p>The JVM on AWS Burstable Instances</p>

<h3>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h3>

<p>So the long awaited answer. So I reread what I said, and what I did fail to mention was that this is only the case with burstable instances, so your t2 instances on AWS.</p>

<p>So using the specs of the AWS CPUs (Intel Xeon 2.5GHz (2.2GHz turbo mode)), I am hazarding a guess that AWS uses mostly this particular CPU (<a href="http://intel.ly/1P8VeKX">http://intel.ly/1P8VeKX</a>) I could be wrong but for this exercise it doesn't really matter. So according to this article (<a href="http://amzn.to/1PrqJM8">http://amzn.to/1PrqJM8</a>), if you are using a t2.micro instance, you have 6 CPU credits/hour at your disposal, which equates to 10% of a CPU core. If you are below the 10% you simple accrue the 6 credits, allowing for far higher CPU usage at a later time. If however you are over that 10%, you start to spend those credits, at a rate that is dependent on how much of the CPU you are utilizing.</p>

<h3>
<a id="method" class="anchor" href="#method" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Method</h3>

<p>So I ran a test this afternoon, <a href="http://bit.ly/1OATLf9">scripts are here</a>. They simply sleep the thread for 40 seconds, then print a number from a list of strings. To get a sense for how consistent the CPU usage was for each script, I looped them with <a href="http://bit.ly/1RXDO6J">this</a>. The aim of this test was to see what effect the JVM had on CPU usage and therefore the cost of running Java on AWS.</p>

<h3>
<a id="results" class="anchor" href="#results" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Results</h3>

<p>Here are the <a href="http://bit.ly/1ZQuypp">results</a>. The red/orange line are the CPU Utilization (CU) of the Golang/Java instances respectively (axis on the left). The brown/purple lines are the CPU credit usage (CCU) for Golang and Java respectively (axis on the right).</p>

<h3>
<a id="discussion" class="anchor" href="#discussion" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Discussion</h3>

<p>Straight out, the CUU for Java is at 0.01, so not very much but notice that CUU for the Golang instance is at 0. The CU for the Java instance is constant, with an initial spike. I imagine the spike is the JVM booting up and it seems that it didn't shut down before the next exec was called each time, which is interesting (would love to hear any suggestions as to why this is). In regards to the Golang instance, the regular spikes in CU are caused by garbage collection (I used the Amazon Linux AMI, which uses Go 1.4, the version before the GC was overhauled).</p>

<h3>
<a id="questions" class="anchor" href="#questions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Questions</h3>

<p>I will do some further tests to see whether more computation heavy programs require more from the JVM. Obviously I will need to avoid anything that triggers JVM Hotspot, so something like a router receiving multiple different requests.</p>

<h3>
<a id="conclusion" class="anchor" href="#conclusion" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conclusion</h3>

<blockquote>
<p>0.01CUU x 24hr = 0.24 CPU credits</p>
</blockquote>

<p>For this test, there is a difference but not enough to make considering a non-JVM stack if you are already running one. If you are not running a JVM stack, why would you go there ;).</p>
        </section>

        <aside id="sidebar">


          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-59567647-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
